!function(){"use strict";L.Google=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1,mapOptions:{backgroundColor:"#dddddd"}},initialize:function(t,e){L.Util.setOptions(this,e),this._ready=google&&void 0!==google.maps.Map,this._ready||L.Google.asyncWait.push(this),this._type=t||"SATELLITE"},onAdd:function(t,e){this._map=t,this._insertAtTheBottom=e,this._initContainer(),this._initMapObject(),t.on("viewreset",this._reset,this),this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this),t.on("move",this._update,this),t.on("zoomanim",this._handleZoomAnim,this),t._controlCorners.bottomright.style.marginBottom="20px",this._reset(),this._update()},onRemove:function(t){t._container.removeChild(this._container),t.off("viewreset",this._reset,this),t.off("move",this._update,this),t.off("zoomanim",this._handleZoomAnim,this),t._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(t){this.options.opacity=t,1>t&&L.DomUtil.setOpacity(this._container,t)},setElementSize:function(t,e){t.style.width=e.x+"px",t.style.height=e.y+"px"},_initContainer:function(){var t=this._map._container,e=t.firstChild;this._container||(this._container=L.DomUtil.create("div","leaflet-google-layer leaflet-top leaflet-left"),this._container.id="_GMapContainer_"+L.Util.stamp(this),this._container.style.zIndex="auto"),t.insertBefore(this._container,e),this.setOpacity(this.options.opacity),this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(this._ready){this._google_center=new google.maps.LatLng(0,0);var t=new google.maps.Map(this._container,{center:this._google_center,zoom:0,tilt:0,mapTypeId:google.maps.MapTypeId[this._type],disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,styles:this.options.mapOptions.styles,backgroundColor:this.options.mapOptions.backgroundColor}),e=this;this._reposition=google.maps.event.addListenerOnce(t,"center_changed",function(){e.onReposition()}),this._google=t,google.maps.event.addListenerOnce(t,"idle",function(){e._checkZoomLevels()}),google.maps.event.addListenerOnce(t,"tilesloaded",function(){e.fire("load")}),this.fire("MapObjectInitialized",{mapObject:t})}},_checkZoomLevels:function(){void 0!==this._map.getZoom()&&this._google.getZoom()!==this._map.getZoom()&&this._map.setZoom(this._google.getZoom())},_reset:function(){this._initContainer()},_update:function(){if(this._google){this._resize();var t=this._map.getCenter(),e=new google.maps.LatLng(t.lat,t.lng);this._google.setCenter(e),void 0!==this._map.getZoom()&&this._google.setZoom(Math.round(this._map.getZoom())),this._checkZoomLevels()}},_resize:function(){var t=this._map.getSize();(this._container.style.width!==t.x||this._container.style.height!==t.y)&&(this.setElementSize(this._container,t),this.onReposition())},_handleZoomAnim:function(t){var e=t.center,i=new google.maps.LatLng(e.lat,e.lng);this._google.setCenter(i),this._google.setZoom(Math.round(t.zoom))},onReposition:function(){this._google&&google.maps.event.trigger(this._google,"resize")}}),L.Google.asyncWait=[],L.Google.asyncInitialize=function(){var t;for(t=0;t<L.Google.asyncWait.length;t++){var e=L.Google.asyncWait[t];e._ready=!0,e._container&&(e._initMapObject(),e._update())}L.Google.asyncWait=[]},L.Yandex=L.Class.extend({includes:L.Mixin.Events,options:{minZoom:0,maxZoom:18,attribution:"",opacity:1,traffic:!1},possibleShortMapTypes:{schemaMap:"map",satelliteMap:"satellite",hybridMap:"hybrid",publicMap:"publicMap",publicMapInHybridView:"publicMapHybrid"},_getPossibleMapType:function(t){var e="yandex#map";if("string"!=typeof t)return e;for(var i in this.possibleShortMapTypes){if(t===this.possibleShortMapTypes[i]){e="yandex#"+t;break}t==="yandex#"+this.possibleShortMapTypes[i]&&(e=t)}return e},initialize:function(t,e){L.Util.setOptions(this,e),this._type=this._getPossibleMapType(t)},onAdd:function(t,e){this._map=t,this._insertAtTheBottom=e,this._initContainer(),this._initMapObject(),t.on("viewreset",this._reset,this),this._limitedUpdate=L.Util.limitExecByInterval(this._update,150,this),t.on("move",this._update,this),t._controlCorners.bottomright.style.marginBottom="3em",this._reset(),this._update(!0)},onRemove:function(t){this._map._container.removeChild(this._container),this._map.off("viewreset",this._reset,this),this._map.off("move",this._update,this),t._controlCorners.bottomright.style.marginBottom="0em"},getAttribution:function(){return this.options.attribution},setOpacity:function(t){this.options.opacity=t,1>t&&L.DomUtil.setOpacity(this._container,t)},setElementSize:function(t,e){t.style.width=e.x+"px",t.style.height=e.y+"px"},_initContainer:function(){var t=this._map._container,e=t.firstChild;this._container||(this._container=L.DomUtil.create("div","leaflet-yandex-layer leaflet-top leaflet-left"),this._container.id="_YMapContainer_"+L.Util.stamp(this),this._container.style.zIndex="auto"),this.options.overlay&&(e=this._map._container.getElementsByClassName("leaflet-map-pane")[0],e=e.nextSibling,L.Browser.opera&&(this._container.className+=" leaflet-objects-pane")),t.insertBefore(this._container,e),this.setOpacity(this.options.opacity),this.setElementSize(this._container,this._map.getSize())},_initMapObject:function(){if(!this._yandex){if(void 0===ymaps.Map)return ymaps.load(["package.map"],this._initMapObject,this);if(this.options.traffic&&(void 0===ymaps.control||void 0===ymaps.control.TrafficControl))return ymaps.load(["package.traffic","package.controls"],this._initMapObject,this);var t=new ymaps.Map(this._container,{center:[0,0],zoom:0,behaviors:[],controls:[]});this.options.traffic&&t.controls.add(new ymaps.control.TrafficControl({shown:!0})),"yandex#null"===this._type&&(this._type=new ymaps.MapType("null",[]),t.container.getElement().style.background="transparent"),t.setType(this._type),this._yandex=t,this._update(!0),this.fire("MapObjectInitialized",{mapObject:t})}},_reset:function(){this._initContainer()},_update:function(t){if(this._yandex){this._resize(t);var e=this._map.getCenter(),i=[e.lat,e.lng],o=this._map.getZoom();(t||this._yandex.getZoom()!==o)&&this._yandex.setZoom(o),this._yandex.panTo(i,{duration:0,delay:0})}},_resize:function(t){var e=this._map.getSize(),i=this._container.style;(i.width!==e.x+"px"||i.height!==e.y+"px"||t===!0)&&(this.setElementSize(this._container,e),this._yandex.container.fitToViewport())}}),L.BingLayer=L.TileLayer.extend({options:{subdomains:[0,1,2,3],type:"Aerial",attribution:"Bing",culture:""},initialize:function(t,e){L.Util.setOptions(this,e),this._key=t,this._url=null,this._providers=[],this.metaRequested=!1},tile2quad:function(t,e,i){for(var o="",n=i;n>0;n--){var a=0,s=1<<n-1;0!==(t&s)&&(a+=1),0!==(e&s)&&(a+=2),o+=a}return o},getTileUrl:function(t){var e=this._getZoomForUrl(),i=this.options.subdomains,o=this.options.subdomains[Math.abs((t.x+t.y)%i.length)];return this._url.replace("{subdomain}",o).replace("{quadkey}",this.tile2quad(t.x,t.y,e)).replace("{culture}",this.options.culture)},loadMetadata:function(){if(!this.metaRequested){this.metaRequested=!0;var t=this,e="_bing_metadata_"+L.Util.stamp(this);window[e]=function(i){window[e]=void 0;var o=document.getElementById(e);o.parentNode.removeChild(o),i.errorDetails||t.initMetadata(i)};var i="file:"===document.location.protocol?"http":document.location.protocol.slice(0,-1),o=i+"://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+e+"&key="+this._key+"&UriScheme="+i,n=document.createElement("script");n.type="text/javascript",n.src=o,n.id=e,document.getElementsByTagName("head")[0].appendChild(n)}},initMetadata:function(t){var e=t.resourceSets[0].resources[0];if(this.options.subdomains=e.imageUrlSubdomains,this._url=e.imageUrl,e.imageryProviders)for(var i=0;i<e.imageryProviders.length;i++)for(var o=e.imageryProviders[i],n=0;n<o.coverageAreas.length;n++){var a=o.coverageAreas[n],s={zoomMin:a.zoomMin,zoomMax:a.zoomMax,active:!1},r=new L.LatLngBounds(new L.LatLng(a.bbox[0]+.01,a.bbox[1]+.01),new L.LatLng(a.bbox[2]-.01,a.bbox[3]-.01));s.bounds=r,s.attrib=o.attribution,this._providers.push(s)}this._update()},_update:function(){null!==this._url&&this._map&&(this._update_attribution(),L.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var t=this._map.getBounds(),e=this._map.getZoom(),i=0;i<this._providers.length;i++){var o=this._providers[i];e<=o.zoomMax&&e>=o.zoomMin&&t.intersects(o.bounds)?(!o.active&&this._map.attributionControl&&this._map.attributionControl.addAttribution(o.attrib),o.active=!0):(o.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(o.attrib),o.active=!1)}},onAdd:function(t){this.loadMetadata(),L.TileLayer.prototype.onAdd.apply(this,[t])},onRemove:function(t){for(var e=0;e<this._providers.length;e++){var i=this._providers[e];i.active&&this._map.attributionControl&&(this._map.attributionControl.removeAttribution(i.attrib),i.active=!1)}L.TileLayer.prototype.onRemove.apply(this,[t])}}),L.bingLayer=function(t,e){return new L.BingLayer(t,e)},function(){function t(){var t={},e=document.URL.toString(),i=e.substring(e.lastIndexOf("?")+1).split(/\&/);return i.map(function(e){var i=e.split(/\=/);t[i[0]]=i[1]}),t}function e(t,e){function i(t,e){var i={};for(var o in t)i[o]="undefined"!=typeof e[o]?e[o]:t[o];return i}function o(t,e){if(t.length<=3)return t;for(var i=t.length,o="",n=0,a=i-1;a>=0;a--){var s=t.substr(a,1);0!=n%3||0==n||isNaN(parseFloat(s))||(o=e+o),o=s+o,n++}return o}if(!t)return"";if("number"!=typeof t&&(t=parseFloat(t),isNaN(t)))return CALCULATING;var n={before:"",after:"",decimals:2,dec_point:".",thousands_sep:","};if(e=e&&"object"==typeof e?i(n,e):n,t=t.toFixed(e.decimals),-1!=t.indexOf("."))var a=t.split("."),t=o(a[0],e.thousands_sep)+e.dec_point+a[1];else var t=o(t,e.thousands_sep);return e.before+t+e.after}var i='<div class="infoPanel">        <div id="cadastreCalcWidget"></div>        <div class="info">            <form id="b_calc">                <h3>Калькулятор земельного налога</h3>                <p>Кадастровый номер:<br><input type="text" name="CAD_NUM" value="50:26:0110121:27" /><input type="button" value="Показать на карте" name="search" onclick="find(this);" /><br>(либо выбрать земельный участок на карте)</p>                <div id="infoError">                    <p id="errStatus">Расчет по кадастровым кварталам и районам не производится (измените масштаб карты чтобы найти ваш участок, либо введите кадастровый номер участка)</p>                </div>                <div id="infoBlock">                    <p>Кадастровая стоимость:<br><input type="text" name="CAD_COST" value="0" /> руб.</p>                    <div id="infoReestr">                        <p>Площадь: <b id="AREA_VALUE">0</b> кв.м.</p>                        <p>Дата обновления: <b id="ACTUAL_DATE"></b></p>                        <p>Адрес (местоположение):<br><b id="OBJECT_ADDRESS"></b></p>                        <p>Форма собственности:<br><b id="FORM_RIGHTS"></b></p>                        <p>Вид разрешенного использования:<br><b id="UTIL_BY_DOC"></b></p>                    </div>                    <p>Налоговая ставка:<br><input type="text" name="prc" value="0.3" style="width: 30px;" />%<br>(уточнить ставку можно <a href="https://www.nalog.ru/rn50/service/tax/" target="_blank">тут</a>)</p>                    <input type="button" value="Рассчитать" name="calcButton" />                    <p id="resultString">Величина налога:<br><b id="result">0</b> руб.</p>                </div>            </form>            <div id="reclamBlock">            </div>            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>            <!-- For maps -->            <ins class="adsbygoogle"                 style="display:inline-block;width:320px;height:100px"                 data-ad-client="ca-pub-3088886844438889"                 data-ad-slot="8884609976"></ins>            <script>            (adsbygoogle = window.adsbygoogle || []).push({});            </script>        </div>    </div>';document.writeln(i);var o=document.getElementById("cadastreCalcWidget"),n=L.tileLayer("//tilessputnik.ru/{z}/{x}/{y}.png",{maxZoom:23,maxNativeZoom:18,attribution:'<a href="//sputnik.ru">sputnik.ru</a>'}),a=t(),s=a.bl||"osm",r=a.CAD_NUM||a.cad||a.cadNum,l=a.x||36.62858426570892,c=a.y||55.481092412215894,p=a.z||18,d=new L.Map(o,{layers:[],center:[c,l],zoom:p}),h={},m=document.getElementById("b_calc"),u=document.getElementById("infoBlock"),_=document.getElementById("infoError"),g=document.getElementById("resultString"),y=document.getElementById("infoReestr"),f=document.getElementById("result");m.calcButton.onclick=function(){var t=Number(m.prc.value.replace(/ /g,"")),i=Number(m.CAD_COST.value.replace(/ /g,""));f.innerHTML=e(i*t/100,{decimals:2,thousands_sep:" "}),g.style.display="block"},m.search.onclick=function(){window.nsGmx.cadastre.searchHook(m.CAD_NUM.value)},m.CAD_NUM.onfocus=function(){_.style.display="none"},r&&(m.CAD_NUM.value=r);var v=window.nsGmx.cadastre.afterViewer({},d);v.addTo(d);var b=function(t){if(u.style.display="block",_.style.display="none",!t||!t.attrs||!t.attrs.cad_cost)return u.style.display="none",_.style.display="block",void 0;g.style.display="block",f.innerHTML="0",y.style.display="block",h=t.attrs,m.CAD_NUM.value=h.id,document.getElementById("AREA_VALUE").innerHTML=e(h.area_value,{decimals:0,thousands_sep:" "}),m.CAD_COST.value=e(h.cad_cost,{decimals:2,thousands_sep:" "}),document.getElementById("OBJECT_ADDRESS").innerHTML=h.address||"";var i="не определена",o=h.pubdate;if("string"==typeof o&&(o=o.replace(/ /g,"")),o||(o=h.adate,"string"==typeof o&&(o=o.replace(/ /g,""))),o&&(i=o),document.getElementById("ACTUAL_DATE").innerHTML=i,h.rights_reg){var n={100:"частная",200:"публичная",300:"«частная и публичная»"};document.getElementById("FORM_RIGHTS").innerHTML=n[h.fp]||"не определена"}document.getElementById("UTIL_BY_DOC").innerHTML=h.util_by_doc||"",m.calcButton.onclick()};d.on("cadastreFeature",function(t){b(t.cadastreFeature)},this);var C=new L.Google;L.control.layers({OSM:n,Google:C},{"Кадастр":v},{collapsed:!L.Browser.mobile,autoZIndex:!1}).addTo(d),d.addLayer("osm"===s?n:C),d.addControl(new L.Control.gmxIcon({id:"getWidget",text:"Виджет",title:"Получить код для вставки на свой сайт"}).on("click",function(){var t="http://russian-face.ru/cadastre/addWidgetCalc.js",e=d.getCenter(),i=d.getZoom(),o=d.hasLayer(n)?"osm":"google";t+="?z="+i,t+="&x="+e.lng,t+="&y="+e.lat,t+="&bl="+o,m.CAD_NUM.value&&(t+="&cad="+m.CAD_NUM.value);var a='<div id="cadastreCalcWidget" style="width: 1080px; height: 800px;"><script src="'+t+'"></script>'+"</div>";window.prompt("Скопируйте текст для вставки на свой сайт:",a)})),d.addControl(new L.Control.gmxIcon({id:"getLink",text:"Ссылка",title:"Получить ссылку"}).on("click",function(){var t="http://russian-face.ru/cadastre/cadastreCalc.html",e=d.getCenter(),i=d.getZoom(),o=d.hasLayer(n)?"osm":"google";t+="?z="+i,t+="&x="+e.lng,t+="&y="+e.lat,t+="&bl="+o,m.CAD_NUM.value&&(t+="&cad="+m.CAD_NUM.value),window.prompt("Скопируйте текст для вставки на свой сайт:",t)}))}(),function(){var t='<div class="recUsl">        Условия размещения <a href="http://russian-face.ru/cadastre/reclama.html">рекламы</a>.    </div>',e=document.getElementById("reclamBlock"),i=2e4,o=[],n=o.length,a=function(){var i=t;if(n){var a=Math.round((n-1)*Math.random());i+='<div class="recItem">'+o[a]+"</div>"}e.innerHTML=i};setInterval(a,i),a()}()}();